flowchart TD
    classDef user color:aqua;
    classDef claude color:orange;
    classDef mcphost color:red;
    classDef solidworks color:chartreuse;

    Start(("ðŸ‘¤ USER")):::user
    ClaudeUI("â˜ï¸ Claude UI"):::claude
    MCPHost("ðŸ§  MCP Host"):::mcphost
    SolidWorks(("ðŸ”§ SOLIDWORKS")):::solidworks

    Start -->|"Prompts & Commands"| ClaudeUI
    Start -->|"Interacts with"| SolidWorks
    ClaudeUI -->|"Sends Prompts"| MCPHost

    subgraph PythonLayer["ðŸ’» Python Layer"]
        MCPHost -->|"Processes Requests"| ContextBuilder["ðŸ“Š Context Builder"]
        ContextBuilder -->|"Generates"| PromptTemplate["ðŸ“ Prompt Template"]
        PromptTemplate -->|"Feeds to"| MCPHost
        MCPHost -->|"Uses"| VersionManager["ðŸ”„ Version Manager"]
    end

    subgraph AdapterLayer["ðŸ§© Adapter Layer"]
        VersionManager -->|"Loads Appropriate"| Adapter{"ðŸ“š Adapter"}
        Adapter --> SW2021["ðŸ§± 2021 API DOC"]
        Adapter --> SW2022["ðŸ§± 2022 API DOC"]
        Adapter --> SW2023["ðŸ§± 2023 API DOC"]
        Adapter --> SW2024["ðŸ§± 2024 API DOC"]
        Adapter --> SW2025["ðŸ§± 2025 API DOC"]
    end

    subgraph APICommunication["ðŸ”„ API Communication"]
        Adapter -->|"PythonNET"| CSharpAPI["ðŸ”Œ C# API"]
        CSharpAPI -->|"COM Interface"| SolidWorks
    end

    SolidWorks -->|"Events & Model Data"| EventCapture["ðŸ“¡ Event Capture"]
    EventCapture -->|"Selection Events"| ActionQueue["â±ï¸ Action Queue"]
    ActionQueue -->|"Focus Elements & History"| ContextBuilder

    SolidWorks -->|"Model Structure"| ModelData["ðŸ—‚ï¸ Model Data"]
    ModelData -->|"Features, Dimensions, etc."| ContextBuilder

    MCPHost -->|"Response"| ClaudeUI
