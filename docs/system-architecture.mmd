graph TD
    User[ðŸ‘¤ User] -->|Prompts & Commands| ClaudeUI["â˜ï¸ Claude UI"]
    User -->|Interacts with| SolidWorks["ðŸ”§ SOLIDWORKS"]
    
    ClaudeUI -->|Sends Prompts| MCPHost["ðŸ§  MCP Host"]
    
    subgraph PythonLayer["Python Layer"]
        MCPHost -->|Processes Requests| ContextBuilder["ðŸ“Š Context Builder"]
        ContextBuilder -->|Generates| PromptTemplate["ðŸ“ Prompt Template"]
        PromptTemplate -->|Feeds to| MCPHost
        MCPHost -->|Uses| VersionManager["ðŸ”„ Version Manager"]
    end
    
    subgraph AdapterLayer["Adapter Layer"]
        VersionManager -->|Loads Appropriate| AdapterDLLs["ðŸ“š Adapter DLLs"]
        AdapterDLLs -->|Contains| SW2021["DLL 2021"]
        AdapterDLLs -->|Contains| SW2022["DLL 2022"]
        AdapterDLLs -->|Contains| SW2023["DLL 2023"]
        AdapterDLLs -->|Contains| SW2024["DLL 2024"]
        AdapterDLLs -->|Contains| SW2025["DLL 2025"]
    end
    
    subgraph APICommunication["API Communication"]
        AdapterDLLs -->|PythonNET| CSharpAPI["ðŸ”Œ C# API"]
        CSharpAPI -->|COM Interface| SolidWorks
    end
    
    SolidWorks -->|Events & Model Data| EventCapture["ðŸ“¡ Event Capture"]
    EventCapture -->|Selection Events| ActionQueue["â±ï¸ Action Queue"]
    ActionQueue -->|Focus Elements & History| ContextBuilder
    
    SolidWorks -->|Model Structure| ModelData["ðŸ—‚ï¸ Model Data"]
    ModelData -->|Features, Dimensions, etc.| ContextBuilder
    
    MCPHost -->|Response| ClaudeUI